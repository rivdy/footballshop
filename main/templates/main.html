{% extends "base.html" %}
{% load humanize %}
{% block title %}Produk — Garuda Football Shop{% endblock %}

{% block content %}

<!-- ====== Header Halaman ====== -->
<div class="section" style="max-width:1080px;margin:0 auto;padding:24px 16px;">
  <div class="page-header" style="margin-bottom:16px;">
    <h1 style="font-size:clamp(24px,2.5vw,32px);line-height:1.2;margin:0;">Latest Products</h1>
    <p style="margin:6px 0 0 0;opacity:.85;">Stay updated with the latest sport items and deals.</p>
  </div>

  <!-- ====== Toolbar (Tabs kiri + Last login kanan) ====== -->
  <div class="toolbar"
       style="display:flex;align-items:center;justify-content:space-between;gap:12px;
              padding:12px 16px;border:1px solid var(--stroke);border-radius:12px;">
    <div class="tabs" style="display:flex;gap:8px;flex-wrap:wrap;">
      <!-- NOTE: jika kamu punya URL filter, ganti href="#" dengan URL-mu -->
      <a href="#" class="tab is-active"
         style="display:inline-block;padding:8px 12px;border:1px solid var(--stroke);border-radius:8px;text-decoration:none;">
        All Products
      </a>
      <a href="#" class="tab"
         style="display:inline-block;padding:8px 12px;border:1px solid var(--stroke);border-radius:8px;text-decoration:none;">
        My Products
      </a>
    </div>
    <div class="last-login" style="font-size:.9rem;opacity:.85;">
      Last login: {{ last_login }}
    </div>
  </div>

  <!-- ====== Flash messages (tetap) ====== -->
  {% if messages %}
    <div style="margin-top:12px;">
      {% for message in messages %}
        <div style="background:#102312;border:1px solid #1f4d2c;color:#c8f3d3;padding:10px;border-radius:10px;margin-bottom:10px">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- ====== EMPTY STATE (bentuk baru) ====== -->
  {% if not products %}
    <div class="card-empty"
         style="margin-top:16px;border:1px solid var(--stroke);border-radius:16px;padding:32px;
                display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;">
      <!-- Ikon kosong: pakai currentColor agar ikut warna teks yang ada -->
      <div aria-hidden="true" style="margin-bottom:12px;opacity:.9;">
        <svg width="96" height="96" viewBox="0 0 96 96" fill="none">
          <circle cx="48" cy="48" r="30" stroke="currentColor" stroke-width="4" opacity="0.3"/>
          <line x1="26" y1="70" x2="70" y2="26" stroke="currentColor" stroke-width="4"/>
        </svg>
      </div>
      <h3 style="margin:8px 0 4px;font-size:1.125rem;line-height:1.3;">No products found</h3>
      <p style="margin:0 0 16px;opacity:.85;">
        Be the first to add items to the shop.
      </p>
      <a class="btn btn-primary" href="{% url 'main:create_product' %}">Create Product</a>
    </div>

  <!-- ====== LIST (kalau ada data) ====== -->
  {% else %}
    <h2 style="margin:20px 0 12px;">Daftar Produk</h2>
    <div class="grid">
      {% for p in products %}
        <div class="card" style="grid-column:span 12;border:1px solid var(--stroke);border-radius:16px;padding:16px;margin-bottom:16px;">
          <div class="row" style="display:flex;gap:16px;align-items:flex-start;">
            {% if p.thumbnail %}
              <img class="thumb" src="{{ p.thumbnail }}" alt="{{ p.name }}"
                   style="width:140px;height:140px;object-fit:cover;border-radius:12px;border:1px solid var(--stroke);" />
            {% else %}
              <img class="thumb" src="https://placehold.co/260x260/0e0e16/8b5cf6?text=No+Image" alt="No image"
                   style="width:140px;height:140px;object-fit:cover;border-radius:12px;border:1px solid var(--stroke);" />
            {% endif %}

            <div style="flex:1;">
              <h3 class="title" style="margin:0 0 6px;">
                <a href="{% url 'main:product_detail' p.pk %}" style="text-decoration:none;">
                  {{ p.name }}
                </a>
              </h3>

              <p class="meta" style="margin:0 0 8px;display:flex;gap:8px;flex-wrap:wrap;">
                <span class="badge" style="border:1px solid var(--stroke);padding:2px 8px;border-radius:999px;">
                  {{ p.get_category_display|default:p.category }}
                </span>
                {% if p.is_featured %}
                  <span class="badge featured" style="border:1px solid var(--stroke);padding:2px 8px;border-radius:999px;">
                    FEATURED
                  </span>
                {% endif %}
              </p>

              <div style="display:flex;gap:12px;align-items:center;margin-bottom:8px;flex-wrap:wrap;">
                <div class="price">Rp {{ p.price|intcomma }}</div>
                {% if p.created_at %}
                  <small style="opacity:.85;">Ditambahkan {{ p.created_at|date:"d M Y, H:i" }}</small>
                {% endif %}
                {% if p.updated_by %}
                  <small style="opacity:.85;">• Terakhir diupdate oleh {{ p.updated_by.username }}</small>
                {% endif %}
              </div>

              <p style="line-height:1.6;margin-bottom:14px;">
                {{ p.description|default:"Tidak ada deskripsi" }}
              </p>

              <div style="display:flex;gap:10px;flex-wrap:wrap;">
                <a class="btn" href="{% url 'main:product_detail' p.pk %}">Detail</a>
                <a class="btn" href="{% url 'main:edit_product' p.pk %}">Edit</a>

                <form method="post" action="{% url 'main:delete_product' p.pk %}"
                      onsubmit="return confirm('Hapus produk ini?');" style="display:inline">
                  {% csrf_token %}
                  <button type="submit" class="btn"
                          style="border-color:rgba(239,68,68,.45);color:#fecaca">Delete</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>
{% endblock %}
